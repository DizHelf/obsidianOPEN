
![[Pasted image 20241010122353.png]]
## На клиенте

```js
&НаКлиенте
Процедура ПрочитатьФайл_XLS()

	ДанныеФайла = Новый ДвоичныеДанные(Объект.ПутьКФайлу);
	АдресДанных = ПоместитьВоВременноеХранилище(ДанныеФайла);
	
	ПрочитатьФайл_XLS_НаСервере(АдресДанных);

КонецПроцедуры // ПрочитатьФайл_XLS()
```

## На сервере

```js
&НаСервере
Процедура ПрочитатьФайл_XLS_НаСервере(АдресДанных)

	ТабДок = Новый ТабличныйДокумент;
	
	Данные = ПолучитьИзВременногоХранилища(АдресДанных);
	ПутьКФайлуНаСервере = ПолучитьИмяВременногоФайла("xls");
	Данные.Записать(ПутьКФайлуНаСервере);
	
	Попытка
		ТабДок.Прочитать(ПутьКФайлуНаСервере, СпособЧтенияЗначенийТабличногоДокумента.Значение);
	Исключение
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = "Не удалось прочитать указанный файл по причине: " + ОписаниеОшибки();
		Сообщение.Сообщить();
		Возврат;
	КонецПопытки;
	
	КоличествоСтрок = ТабДок.ВысотаТаблицы;
	
	Для НомерСтроки = 2 По КоличествоСтрок Цикл
		СтрокаДанных = Объект.ДанныеФайла.Добавить();
		СтрокаДанных.Наименование			= ТабДок.ПолучитьОбласть("R" + Формат(НомерСтроки, "ЧГ=0") + "C" + 1).ТекущаяОбласть.Текст;
		СтрокаДанных.ПолноеНаименование		= ТабДок.ПолучитьОбласть("R" + Формат(НомерСтроки, "ЧГ=0") + "C" + 2).ТекущаяОбласть.Текст;
		СтрокаДанных.УНП					= ТабДок.ПолучитьОбласть("R" + Формат(НомерСтроки, "ЧГ=0") + "C" + 3).ТекущаяОбласть.Текст;
	КонецЦикла;

КонецПроцедуры // ПрочитатьФайл_XLS_НаСервере()
```
