## Теоретическая схема

![[Pasted image 20241011094940.png]]

## Практическое решение

Как пример я буду рассматривать вот этот код [[[Чтение различных типов файлов] XLS]] (я уже поменял на правильное решение)
## На клиенте

На клиенте надо будет создать 2ичный адрес файла а потом поместить этот адрес во временное хранилище.

```js
&НаКлиенте
Процедура ПрочитатьФайл_XLS()

	//---------------------------------------------------------------------------
	ДанныеФайла = Новый ДвоичныеДанные(Объект.ПутьКФайлу);
	АдресДанных = ПоместитьВоВременноеХранилище(ДанныеФайла);
	//---------------------------------------------------------------------------
	
	ПрочитатьФайл_XLS_НаСервере(АдресДанных);

КонецПроцедуры // ПрочитатьФайл_XLS()
```
## На сервере

На сервере надо получить данные из временного хранилища, создать путь (туда куда мы положим файл) на сервере, а далее записать его по этому пути.

```js
&НаСервере
Процедура ПрочитатьФайл_XLS_НаСервере(АдресДанных)

	ТабДок = Новый ТабличныйДокумент;
	
	//---------------------------------------------------------------------------
	Данные = ПолучитьИзВременногоХранилища(АдресДанных);
	ПутьКФайлуНаСервере = ПолучитьИмяВременногоФайла("xls");
	Данные.Записать(ПутьКФайлуНаСервере);
	//---------------------------------------------------------------------------

	Попытка
		ТабДок.Прочитать(ПутьКФайлуНаСервере, СпособЧтенияЗначенийТабличногоДокумента.Значение);
	Исключение
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = "Не удалось прочитать указанный файл по причине: " + ОписаниеОшибки();
		Сообщение.Сообщить();
		Возврат;
	КонецПопытки;
	
	КоличествоСтрок = ТабДок.ВысотаТаблицы;
	
	Для НомерСтроки = 2 По КоличествоСтрок Цикл
		СтрокаДанных = Объект.ДанныеФайла.Добавить();
		СтрокаДанных.Наименование			= ТабДок.ПолучитьОбласть("R" + Формат(НомерСтроки, "ЧГ=0") + "C" + 1).ТекущаяОбласть.Текст;
		СтрокаДанных.ПолноеНаименование		= ТабДок.ПолучитьОбласть("R" + Формат(НомерСтроки, "ЧГ=0") + "C" + 2).ТекущаяОбласть.Текст;
		СтрокаДанных.УНП					= ТабДок.ПолучитьОбласть("R" + Формат(НомерСтроки, "ЧГ=0") + "C" + 3).ТекущаяОбласть.Текст;
	КонецЦикла;

КонецПроцедуры // ПрочитатьФайл_XLS_НаСервере()
```

