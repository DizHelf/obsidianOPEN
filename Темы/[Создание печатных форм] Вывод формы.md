## Теория

Скажу сразу тут будет <span style="color:rgb(17, 197, 53)">развёрнутое теоретическое вступление</span>, я буду максимально подробно расписывать каждой шаг, Сама прога будет в разделе [[#Практика]]

Для начала нам потребуется создать новую команду <span style="color:rgb(17, 197, 53)">в том же документе</span> где у нас лежит макет. После чего установить настройки.

![[Pasted image 20241015101415.png]]

Теперь напишем клиентскую часть программы, в комментариях у меня пояснения

```js
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)

	ТабДок = Новый ТабличныйДокумент;
	//Печать - будет отвечать за заполнение формы
	//ПараметрКоманды - Это ссылка на документ
	Печать(ТабДок, ПараметрКоманды);
	//ТабДок.Показать("Гарантийный талон") - Показывает что у на в ТабДок
	//"Гарантийный талон" - Заголовок
	ТабДок.Показать("Гарантийный талон");
	
КонецПроцедуры
```

Этой частью кода я просто проверяю подцепляются ли данные макета и выводятся ли они

```js
&НаСервере
Процедура Печать(ТабДок, СсылкаНаДокумент)

	//Получить макет
	Макет = Документы.РеализацияТоваровУслуг.ПолучитьМакет("ГарантийныйТалон");
	
	//Получение облостей из макета
	ОблостьШапки = Макет.ПолучитьОбласть("Шапка");
	ОблостьШапкаТаблицы = Макет.ПолучитьОбласть("ШапкаТаблицы");
	ОблостьСтрокаТаблицы = Макет.ПолучитьОбласть("СтрокаТаблицы");
	ОблостьПодвал = Макет.ПолучитьОбласть("Подвал");
	ОблостьТекстСоглашения = Макет.ПолучитьОбласть("ТекстСоглашения");
	
	//Заполнение пораметров и вывод облостей в табличный документ
	
	//Шапка
	ТабДок.Вывести(ОблостьШапки);
	
	//ШапкаТаблицы
	ТабДок.Вывести(ОблостьШапкаТаблицы);
	
	//СтрокаТаблицы
	ТабДок.Вывести(ОблостьСтрокаТаблицы);
	
	//Подвал
	ТабДок.Вывести(ОблостьПодвал);
	
	//ТекстСоглашения
	ТабДок.Вывести(ОблостьТекстСоглашения);

КонецПроцедуры // ()
```

В конце перед выводом каждого раздела нужно будет ввести в них данные


```js
//Шапка
ОблостьШапки.Параметры.НазваниеОрганизации = Константы.НазваниеОрганизации.Получить();
ОблостьШапки.Параметры.Номер = СсылкаНаДокумент.Номер;
ОблостьШапки.Параметры.Дата = Формат(СсылкаНаДокумент.Дата, "ДЛФ=ДД");
ТабДок.Вывести(ОблостьШапки);

//ШапкаТаблицы
ТабДок.Вывести(ОблостьШапкаТаблицы);

//СтрокаТаблицы
Запрос = Новый Запрос;
Запрос.Текст = 
	"ВЫБРАТЬ
	|	РеализацияТоваровУслугТовары.НомерСтроки,
	|	РеализацияТоваровУслугТовары.Номенклатура.Артикул,
	|	РеализацияТоваровУслугТовары.Цена,
	|	РеализацияТоваровУслугТовары.Всего,
	|	РеализацияТоваровУслугТовары.Количество,
	|	РеализацияТоваровУслугТовары.Номенклатура.Наименование
	|ИЗ
	|	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары";

РезультатЗапроса = Запрос.Выполнить();
ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();

ИтоговаяСумма = 0;

Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
	//Заполнение полей таблицы
	ОблостьСтрокаТаблицы.Параметры.НомерСтроки = ВыборкаДетальныеЗаписи.НомерСтроки;
	ОблостьСтрокаТаблицы.Параметры.Цена = ВыборкаДетальныеЗаписи.Цена;
	ОблостьСтрокаТаблицы.Параметры.Артикул = ВыборкаДетальныеЗаписи.НоменклатураАртикул;
	ОблостьСтрокаТаблицы.Параметры.НаименованиеТовара = ВыборкаДетальныеЗаписи.НоменклатураНаименование;
	ОблостьСтрокаТаблицы.Параметры.Всего = ВыборкаДетальныеЗаписи.Всего;
	ОблостьСтрокаТаблицы.Параметры.Количество = ВыборкаДетальныеЗаписи.Количество;
	
	ИтоговаяСумма = ИтоговаяСумма + ВыборкаДетальныеЗаписи.Всего;
	
	ТабДок.Вывести(ОблостьСтрокаТаблицы);
КонецЦикла;

//Подвал
ОблостьПодвал.Параметры.СуммаИтого = ИтоговаяСумма;
ТабДок.Вывести(ОблостьПодвал);

//ТекстСоглашения
ТабДок.Вывести(ОблостьТекстСоглашения);
```
## Практика

Полная программа

```js
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)

	ТабДок = Новый ТабличныйДокумент;
	//Печать - будет отвечать за заполнение формы
	//ПараметрКоманды - Это ссылка на документ
	Печать(ТабДок, ПараметрКоманды);
	//ТабДок.Показать("Гарантийный талон") - Показывает что у на в ТабДок
	//"Гарантийный талон" - Заголовок
	ТабДок.Показать("Гарантийный талон");
	
КонецПроцедуры

&НаСервере
Процедура Печать(ТабДок, СсылкаНаДокумент)

	//Получить макет
	Макет = Документы.РеализацияТоваровУслуг.ПолучитьМакет("ГарантийныйТалон");
	
	//Получение облостей из макета
	ОблостьШапки = Макет.ПолучитьОбласть("Шапка");
	ОблостьШапкаТаблицы = Макет.ПолучитьОбласть("ШапкаТаблицы");
	ОблостьСтрокаТаблицы = Макет.ПолучитьОбласть("СтрокаТаблицы");
	ОблостьПодвал = Макет.ПолучитьОбласть("Подвал");
	ОблостьТекстСоглашения = Макет.ПолучитьОбласть("ТекстСоглашения");
	
	//Заполнение пораметров и вывод облостей в табличный документ
	
	//Шапка
	ОблостьШапки.Параметры.НазваниеОрганизации = Константы.НазваниеОрганизации.Получить();
	ОблостьШапки.Параметры.Номер = СсылкаНаДокумент.Номер;
	ОблостьШапки.Параметры.Дата = Формат(СсылкаНаДокумент.Дата, "ДЛФ=ДД");
	
	ТабДок.Вывести(ОблостьШапки);
	
	//ШапкаТаблицы
	ТабДок.Вывести(ОблостьШапкаТаблицы);
	
	//СтрокаТаблицы
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	РеализацияТоваровУслугТовары.НомерСтроки,
		|	РеализацияТоваровУслугТовары.Номенклатура.Артикул,
		|	РеализацияТоваровУслугТовары.Цена,
		|	РеализацияТоваровУслугТовары.Всего,
		|	РеализацияТоваровУслугТовары.Количество,
		|	РеализацияТоваровУслугТовары.Номенклатура.Наименование
		|ИЗ
		|	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	ИтоговаяСумма = 0;
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		//Заполнение полей таблицы
		ОблостьСтрокаТаблицы.Параметры.НомерСтроки = ВыборкаДетальныеЗаписи.НомерСтроки;
		ОблостьСтрокаТаблицы.Параметры.Цена = ВыборкаДетальныеЗаписи.Цена;
		ОблостьСтрокаТаблицы.Параметры.Артикул = ВыборкаДетальныеЗаписи.НоменклатураАртикул;
		ОблостьСтрокаТаблицы.Параметры.НаименованиеТовара = ВыборкаДетальныеЗаписи.НоменклатураНаименование;
		ОблостьСтрокаТаблицы.Параметры.Всего = ВыборкаДетальныеЗаписи.Всего;
		ОблостьСтрокаТаблицы.Параметры.Количество = ВыборкаДетальныеЗаписи.Количество;
		
		ИтоговаяСумма = ИтоговаяСумма + ВыборкаДетальныеЗаписи.Всего;
		
		ТабДок.Вывести(ОблостьСтрокаТаблицы);
	КонецЦикла;
	
	//Подвал
	ОблостьПодвал.Параметры.СуммаИтого = ИтоговаяСумма;
	ТабДок.Вывести(ОблостьПодвал);
	
	//ТекстСоглашения
	ТабДок.Вывести(ОблостьТекстСоглашения);

КонецПроцедуры // ()
```
